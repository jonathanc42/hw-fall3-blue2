plot(cars)
source('~/GitHub/hw-fall3-blue2/Simulation/HW-1.R', echo=TRUE)
source('~/GitHub/hw-fall3-blue2/Simulation/HW-1.R', echo=TRUE)
dev.off()
source('~/GitHub/hw-fall3-blue2/Simulation/HW-1.R', echo=TRUE)
source('~/GitHub/hw-fall3-blue2/Simulation/HW-1.R', echo=TRUE)
max(Simulation.normal)
return.mean
return.sd
source('~/GitHub/hw-fall3-blue2/Simulation/HW-2.R', echo=TRUE)
source('~/GitHub/hw-fall3-blue2/Simulation/HW-2.R', echo=TRUE)
source('~/GitHub/hw-fall3-blue2/Simulation/HW-2.R', echo=TRUE)
source('~/GitHub/hw-fall3-blue2/Simulation/HW-2.R', echo=TRUE)
source('~/GitHub/hw-fall3-blue2/Simulation/HW-2.R', echo=TRUE)
summary(return)
# Seismic and Lease Costs
rnorm(n = simulation.size)
# Seismic and Lease Costs
rnorm(n = simulation.size, mean = 600, sd = 50) * 960
source('~/GitHub/hw-fall3-blue2/Simulation/HW-2.R', echo=TRUE)
IC
rtriangle(n = simulation.size, 172000, 215000, 279500)
rtriangle(simulation.size, 172000, 215000, 279500)
rtriangle(simulation.size, 172000, 279500, 215000)
source('~/GitHub/hw-fall3-blue2/Simulation/HW-2.R', echo=TRUE)
# normality test w qq plot
qqPlot(IC, main='Normal Q-Q Plot 1991:2006')
# normality test w qq plot
qqPlot(IC, main='Normal Q-Q Plot Inicial Cost')
source('~/GitHub/hw-fall3-blue2/Simulation/HW-2.R', echo=TRUE)
?dnorm
hist(IC, breaks=100, main='Initial Dry Well Cost 2019', xlab='Cost')
lines(dnorm(x=linspace(min(IC), max(IC), n = simulation.size), mean = IC.mean, sd = IC.sd), col="blue", lwd=2)
lines(dnorm(x=c(min(IC), max(IC), n = simulation.size), mean = IC.mean, sd = IC.sd), col="blue", lwd=2)
myhist <- hist(IC)
multiplier <- myhist$counts / myhist$density
mydensity <- dnorm(x=c(min(IC), max(IC), n = simulation.size))
mydensity$y <- mydensity$y * multiplier[1]
plot(myhist)
lines(mydensity)
myhist <- hist(IC)
summary(IC)
describe(IC)
info(IC)
IC <- Cost + LC + SC + CC + PO
myhist <- hist(IC)
library(readxl)
library(dplyr)
library(triangle)
library(ks)
library(car) # plot qq plot with confidence interval
# read in data
df<-read_excel('Simulation/Analysis_Data2.xlsx',sheet=2)
#### get return 1991 to 2006 ####
return <- df %>% filter(Date %in% 1991:2006) %>%
select(Return_crude,Return_gas,Return_dry)
return <- as.numeric(unlist(return))
return.sd=sd(return)
return.mean=mean(return)
# get average drill cost of 2016
cost2016=mean(as.numeric(df %>% filter(Date==2006) %>%
select(Cost_crude,cost_gas,Cost_dry)))
#### Initial setting ####
set.seed(42)
# simulation.size=10000000
simulation.size=100000
#### Initial cost ####
# 2019 drilling cost
P.n <- cbind(matrix(data=rnorm(n=(6 * simulation.size), mean=return.mean, sd=return.sd)+1,
nrow=simulation.size, byrow = TRUE),
matrix(data=rtriangle(3 * simulation.size, -0.22, -0.07, -0.0917)+1,
nrow=simulation.size, byrow = TRUE),
matrix(data=rtriangle(4 * simulation.size, 0.02,0.06,0.05)+1,
nrow=simulation.size, byrow = TRUE))
Cost <- apply(P.n,1,prod)*cost2016
# Lease Costs
LC <- rnorm(n = simulation.size, mean = 600, sd = 50) * 960
# Seismic Costs
SC <- rnorm(n = simulation.size, mean = 3, sd = 0.35) * 43000
# Completion Costs
CC <- rnorm(n = simulation.size, mean = 390000, sd = 50000)
# Professional Overhead
PO <- rtriangle(simulation.size, 172000, 279500, 215000)
IC <- Cost + LC + SC + CC + PO
# abline(v = cost2016, col="red", lwd=2)
# mtext("Cost 2006", at=cost2016, col="red")
# Summary
median(IC)
IC.mean <- mean(IC)
IC.sd <- sd(IC)
quantile(IC, c(.05, .95))
sd(IC)/mean(IC)
myhist <- hist(IC)
multiplier <- myhist$counts / myhist$density
mydensity <- dnorm(x=c(min(IC), max(IC), n = simulation.size))
mydensity$y <- mydensity$y * multiplier[1]
mydensity
x
dnorm(x=c(min(IC), max(IC), n = simulation.size))
min(IC)
max(IC)
mydensity <- dnorm(x=c(min(IC), max(IC), n = simulation.size), mean = IC.mean, sd = IC.sd))
mydensity <- dnorm(x=c(min(IC), max(IC), n = simulation.size), mean = IC.mean, sd = IC.sd)
mydensity
mydensity <- dnorm(x=c(min(IC), max(IC), n = simulation.size), mean = IC.mean, sd = IC.sd)
mydensity$y <- mydensity$y * multiplier[1]
multiplier
multiplier <- myhist$counts / myhist$density
multiplier
myhist$counts
myhist$density
myhist <- hist(IC)
h <- hist(IC, breaks = 10, density = 10,
col = "lightgray", xlab = "Accuracy", main = "Overall")
xfit <- seq(min(g), max(g), length = 40)
xfit <- seq(min(IC), max(IC), length = 40)
xfit
yfit <- dnorm(xfit, mean = mean(IC), sd = sd(IC))
yfit <- yfit * diff(h$mids[1:2]) * length(g)
yfit <- yfit * diff(h$mids[1:2]) * length(IC)
lines(xfit, yfit, col = "black", lwd = 2)
h <- hist(IC, breaks = 100, density = 10,
col = "lightgray", xlab = "Accuracy", main = "Overall")
h <- hist(IC, breaks = 100,
col = "lightgray", xlab = "Accuracy", main = "Overall")
xfit <- seq(min(IC), max(IC), length = 40)
yfit <- dnorm(xfit, mean = mean(IC), sd = sd(IC))
yfit <- yfit * diff(h$mids[1:2]) * length(IC)
lines(xfit, yfit, col = "black", lwd = 2)
h <- hist(IC, breaks = 100,
col = "lightgray", xlab = "Accuracy", main = "Overall")
xfit <- seq(min(IC), max(IC), length = 40)
yfit <- dnorm(xfit, mean = mean(IC), sd = sd(IC))
yfit <- yfit * diff(h$mids[1:2]) * length(IC)
lines(xfit, yfit, col = "blue", lwd = 2)
h <- hist(IC, breaks = 100, main='Initial Dry Well Cost 2019',
col = "lightgray", xlab = "Accuracy", main = "Overall")
h <- hist(IC, breaks = 100, main='Initial Dry Well Cost 2019',
col = "lightgray", xlab = "Accuracy", main = "Overall")
h <- hist(IC, breaks = 100, main='Initial Dry Well Cost 2019',
col = "lightgray", xlab = "Accuracy")
xfit <- seq(min(IC), max(IC), length = 40)
yfit <- dnorm(xfit, mean = mean(IC), sd = sd(IC))
yfit <- yfit * diff(h$mids[1:2]) * length(IC)
lines(xfit, yfit, col = "blue", lwd = 2)
# plot the histogray and add a normal line to check the fit
h <- hist(IC, breaks = 100, main='Initial Dry Well Cost 2019',
col = "lightgray", xlab = "Cost")
xfit <- seq(min(IC), max(IC), length = 40)
yfit <- dnorm(xfit, mean = mean(IC), sd = sd(IC))
yfit <- yfit * diff(h$mids[1:2]) * length(IC)
lines(xfit, yfit, col = "blue", lwd = 2)
source('~/GitHub/hw-fall3-blue2/Simulation/HW-1.R', echo=TRUE)
source('~/GitHub/hw-fall3-blue2/Simulation/HW-2.R', echo=TRUE)
rm(list=ls())
dev.off()
source('~/GitHub/hw-fall3-blue2/Simulation/HW-2.R', echo=TRUE)
dev.off()
dev.off()
source('~/GitHub/hw-fall3-blue2/Simulation/HW-2.R', echo=TRUE)
IC.mean
IC.sd
median(NPV)
mean(NPV)
sd(NPV)
quantile(NPV, c(.05, .95))
sd(NPV)/mean(NPV)
source('~/GitHub/hw-fall3-blue2/Simulation/HW-2.R', echo=TRUE)
write.csv(x = NPV,file = 'NPV.csv')
write.csv(x = IC,file = 'IC.csv')
rm(list=ls())
source('~/GitHub/hw-fall3-blue2/Simulation/HW-2.R', echo=TRUE)
# plot the histogray and add a normal line to check the fit to make it look even normal
h <- hist(IC, breaks = 100, main='Initial Dry Well Cost 2019',
col = "lightgray", xlab = "Cost")
xfit <- seq(min(IC), max(IC), length = 40)
yfit <- dnorm(xfit, mean = mean(IC), sd = sd(IC))
yfit <- yfit * diff(h$mids[1:2]) * length(IC)
lines(xfit, yfit, col = "blue", lwd = 2)
# plot the histogray and add a normal line to check the fit to make it look even normal
h <- hist(IC, breaks = 100, main='Initial Dry Well Cost 2019',
col = "lightgray", xlab = "Cost")
# plot the histogray and add a normal line to check the fit to make it look even normal
h <- hist(IC//1e6, breaks = 100, main='Initial Dry Well Cost 2019',
col = "lightgray", xlab = "Cost in Million")
# plot the histogray and add a normal line to check the fit to make it look even normal
h <- hist(IC/1e6, breaks = 100, main='Initial Dry Well Cost 2019',
col = "lightgray", xlab = "Cost in Million")
# visualize the value
# in order to present less zeros, using millions, you making crazy money
hist(NPV/1e6, xlab = 'Million',main='Net Present Value 2033')
# visualize the value
# in order to present less zeros, using millions, you making crazy money
hist(NPV/1e6, xlab = 'Value in Million',main='Net Present Value 2033')
# visualize the value
# in order to present less zeros, using millions, you making crazy money
hist(NPV/1e6, breaks = 100,xlab = 'Value in Million',main='Net Present Value 2033')
# VaR at 1 %
quantile(NPV, c(.01))
quantile(NPV, c(.01))/1e6
abline(v = quantile(NPV, c(.01)), col="red", lwd=2)
abline(v = quantile(NPV, c(.01)), col="red", lwd=2)
mtext("1% VaR: -4.5M", at=quantile(NPV, c(.01)), col="red")
# visualize the value
# in order to present less zeros, using millions, you making crazy money
hist(NPV/1e6, breaks = 100,xlab = 'Value in Million',main='Net Present Value 2033')
abline(v = quantile(NPV, c(.01)), col="red", lwd=2)
mtext("1% VaR: -4.5M", at=quantile(NPV, c(.01)), col="red")
abline(v = quantile(NPV, c(.01))/1e6, col="red", lwd=2)
mtext("1% VaR: -4.5M", at=quantile(NPV, c(.01))/1e6, col="red")
# if you want to see the change after decomposition
# you can also change the position of IP and DR
# you will see how panic the uniform distribution deshaped
# summary(DR)
# summary(IP)
# hist(IP)
# hist(DR)
# summary(DR.transformed)
# summary(IP.transformed)
hist(DR.transformed)
hist(IP.transformed)
BothX <- cbind(standardize(IP), standardize(DR))
SBX <- t(U %*% t(BothX))
final.SBX <- cbind(destandardize(SBX[,1], IP), destandardize(SBX[,2], DR))
DR.transformedX <- final.SBX[,1]
IP.transformedX <- final.SBX[,2]
hist(DR.transformedX)
hist(IP.transformedX)
par(mfrow=c(1,2))
hist(DR.transformed, breaks=100, main="Decline Rate")
hist(IP.transformed, breaks=100, main="Initial Production")
hist(DR.transformedX, breaks=100, main="Decline Rate")
hist(IP.transformedX, breaks=100, main="Initial Production")
par(mfrow=c(1,2))
hist(DR.transformed, breaks=100, main="Decline Rate (uniform)", xlab = "DR Rate")
hist(IP.transformed, breaks=100, main="Initial Production (lognormal)", xlab = "Initial Production")
hist(DR.transformedX, breaks=100, main="Decline Rate (uniform)", xlab = "DR Rate")
hist(IP.transformedX, breaks=100, main="Initial Production(lognormal)", xlab = "Initial Production")
par(mfrow=c(1,4))
hist(DR.transformed, breaks=100, main="Decline Rate (uniform)", xlab = "DR Rate")
hist(IP.transformed, breaks=100, main="Initial Production (lognormal)", xlab = "Initial Production")
hist(DR.transformedX, breaks=100, main="Decline Rate (uniform)", xlab = "DR Rate")
hist(IP.transformedX, breaks=100, main="Initial Production(lognormal)", xlab = "Initial Production")
par(mfrow=c(2,2))
hist(DR.transformed, breaks=100, main="Decline Rate (uniform)", xlab = "DR Rate")
hist(IP.transformed, breaks=100, main="Initial Production (lognormal)", xlab = "Initial Production")
hist(DR.transformedX, breaks=100, main="Decline Rate (uniform)", xlab = "DR Rate")
hist(IP.transformedX, breaks=100, main="Initial Production(lognormal)", xlab = "Initial Production")
par(mfrow=c(1,2))
hist(DR.transformed, breaks=100, main="Decline Rate (uniform) correct", xlab = "DR Rate")
hist(DR.transformedX, breaks=100, main="Decline Rate (uniform) wrong", xlab = "DR Rate")
sd(NPV)/mean(NPV)
par(mfrow=c(1,4))
hist(DR.transformed, breaks=100, main="Decline Rate (uniform) correct", xlab = "DR Rate")
hist(IP.transformed, breaks=100, main="Initial Production (lognormal)", xlab = "Initial Production")
hist(IP.transformedX, breaks=100, main="Initial Production(lognormal)", xlab = "Initial Production")
hist(DR.transformedX, breaks=100, main="Decline Rate (uniform) wrong", xlab = "DR Rate")
par(mfrow=c(1,4))
hist(DR.transformed, breaks=100, main="Decline Rate (uniform) correct", xlab = "DR Rate")
hist(IP.transformed, breaks=100, main="Initial Production (lognormal)", xlab = "Initial Production")
hist(IP.transformedX, breaks=100, main="Decline Rate (uniform) wrong", xlab = "DR Rate")
hist(DR.transformedX, breaks=100, main="Initial Production(lognormal) wrong", xlab = "Initial Production")
par(mfrow=c(1,4))
hist(DR.transformed, breaks=100, main="Decline Rate (uniform) correct", xlab = "DR Rate")
hist(IP.transformed, breaks=100, main="Initial Production (lognormal)", xlab = "Initial Production")
hist(IP.transformedX, breaks=100, main="Decline Rate (uniform) wrong", xlab = "DR Rate")
hist(DR.transformedX, breaks=100, main="Initial Production(lognormal) wrong",
xlab = "Initial Production",xlim = c(0, 1500))
par(mfrow=c(1,4))
hist(DR.transformed, breaks=100, main="Decline Rate (uniform) correct",
xlab = "DR Rate", xlim = c(0, 0.5))
hist(IP.transformed, breaks=100, main="Initial Production (lognormal)", xlab = "Initial Production")
hist(IP.transformedX, breaks=100, main="Decline Rate (uniform) wrong",
xlab = "DR Rate", xlim = c(0, 0.5))
hist(DR.transformedX, breaks=100, main="Initial Production(lognormal) wrong",
xlab = "Initial Production",xlim = c(0, 1500))
par(mfrow=c(1,4))
hist(DR.transformed, breaks=100, main="Decline Rate (uniform) correct",
xlab = "DR Rate", xlim = c(0, 0.5), density = 0.5)
hist(IP.transformed, breaks=100, main="Initial Production (lognormal)", xlab = "Initial Production")
hist(IP.transformedX, breaks=100, main="Decline Rate (uniform) wrong",
xlab = "DR Rate", xlim = c(0, 0.5))
hist(DR.transformedX, breaks=100, main="Initial Production(lognormal) wrong",
xlab = "Initial Production",xlim = c(0, 1500))
par(mfrow=c(1,4))
hist(DR.transformed, breaks=100, main="Decline Rate (uniform) correct",
xlab = "DR Rate", xlim = c(0.1, 0.35), density = 0.5)
hist(IP.transformed, breaks=100, main="Initial Production (lognormal)", xlab = "Initial Production")
hist(IP.transformedX, breaks=100, main="Decline Rate (uniform) wrong",
xlab = "DR Rate", xlim = c(0.1, 0.35))
hist(DR.transformedX, breaks=100, main="Initial Production(lognormal) wrong",
xlab = "Initial Production",xlim = c(0, 1500))
hist(DR.transformed, breaks=100, main="Decline Rate (uniform) correct",
xlab = "DR Rate", xlim = c(0.1, 0.35), density = 0.5)
hist(IP.transformed, breaks=100, main="Initial Production (lognormal)", xlab = "Initial Production")
hist(IP.transformedX, breaks=100, main="Decline Rate (uniform) wrong",
xlab = "DR Rate")
hist(DR.transformedX, breaks=100, main="Initial Production(lognormal) wrong",
xlab = "Initial Production",xlim = c(0, 1500))
par(mfrow=c(1,4))
hist(DR.transformed, breaks=100, main="Decline Rate (uniform) correct",
xlab = "DR Rate", xlim = c(0.1, 0.35))
hist(IP.transformed, breaks=100, main="Initial Production (lognormal)", xlab = "Initial Production")
hist(IP.transformedX, breaks=100, main="Decline Rate (uniform) wrong",
xlab = "DR Rate")
hist(DR.transformedX, breaks=100, main="Initial Production(lognormal) wrong",
xlab = "Initial Production",xlim = c(0, 1500))
