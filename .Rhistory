plot(cars)
source('~/GitHub/hw-fall3-blue2/Simulation/HW-1.R', echo=TRUE)
source('~/GitHub/hw-fall3-blue2/Simulation/HW-1.R', echo=TRUE)
dev.off()
source('~/GitHub/hw-fall3-blue2/Simulation/HW-1.R', echo=TRUE)
source('~/GitHub/hw-fall3-blue2/Simulation/HW-1.R', echo=TRUE)
max(Simulation.normal)
return.mean
return.sd
source('~/GitHub/hw-fall3-blue2/Simulation/HW-2.R', echo=TRUE)
source('~/GitHub/hw-fall3-blue2/Simulation/HW-2.R', echo=TRUE)
source('~/GitHub/hw-fall3-blue2/Simulation/HW-2.R', echo=TRUE)
source('~/GitHub/hw-fall3-blue2/Simulation/HW-2.R', echo=TRUE)
source('~/GitHub/hw-fall3-blue2/Simulation/HW-2.R', echo=TRUE)
summary(return)
# Seismic and Lease Costs
rnorm(n = simulation.size)
# Seismic and Lease Costs
rnorm(n = simulation.size, mean = 600, sd = 50) * 960
source('~/GitHub/hw-fall3-blue2/Simulation/HW-2.R', echo=TRUE)
IC
rtriangle(n = simulation.size, 172000, 215000, 279500)
rtriangle(simulation.size, 172000, 215000, 279500)
rtriangle(simulation.size, 172000, 279500, 215000)
source('~/GitHub/hw-fall3-blue2/Simulation/HW-2.R', echo=TRUE)
# normality test w qq plot
qqPlot(IC, main='Normal Q-Q Plot 1991:2006')
# normality test w qq plot
qqPlot(IC, main='Normal Q-Q Plot Inicial Cost')
source('~/GitHub/hw-fall3-blue2/Simulation/HW-2.R', echo=TRUE)
?dnorm
hist(IC, breaks=100, main='Initial Dry Well Cost 2019', xlab='Cost')
lines(dnorm(x=linspace(min(IC), max(IC), n = simulation.size), mean = IC.mean, sd = IC.sd), col="blue", lwd=2)
lines(dnorm(x=c(min(IC), max(IC), n = simulation.size), mean = IC.mean, sd = IC.sd), col="blue", lwd=2)
myhist <- hist(IC)
multiplier <- myhist$counts / myhist$density
mydensity <- dnorm(x=c(min(IC), max(IC), n = simulation.size))
mydensity$y <- mydensity$y * multiplier[1]
plot(myhist)
lines(mydensity)
myhist <- hist(IC)
summary(IC)
describe(IC)
info(IC)
IC <- Cost + LC + SC + CC + PO
myhist <- hist(IC)
library(readxl)
library(dplyr)
library(triangle)
library(ks)
library(car) # plot qq plot with confidence interval
# read in data
df<-read_excel('Simulation/Analysis_Data2.xlsx',sheet=2)
#### get return 1991 to 2006 ####
return <- df %>% filter(Date %in% 1991:2006) %>%
select(Return_crude,Return_gas,Return_dry)
return <- as.numeric(unlist(return))
return.sd=sd(return)
return.mean=mean(return)
# get average drill cost of 2016
cost2016=mean(as.numeric(df %>% filter(Date==2006) %>%
select(Cost_crude,cost_gas,Cost_dry)))
#### Initial setting ####
set.seed(42)
# simulation.size=10000000
simulation.size=100000
#### Initial cost ####
# 2019 drilling cost
P.n <- cbind(matrix(data=rnorm(n=(6 * simulation.size), mean=return.mean, sd=return.sd)+1,
nrow=simulation.size, byrow = TRUE),
matrix(data=rtriangle(3 * simulation.size, -0.22, -0.07, -0.0917)+1,
nrow=simulation.size, byrow = TRUE),
matrix(data=rtriangle(4 * simulation.size, 0.02,0.06,0.05)+1,
nrow=simulation.size, byrow = TRUE))
Cost <- apply(P.n,1,prod)*cost2016
# Lease Costs
LC <- rnorm(n = simulation.size, mean = 600, sd = 50) * 960
# Seismic Costs
SC <- rnorm(n = simulation.size, mean = 3, sd = 0.35) * 43000
# Completion Costs
CC <- rnorm(n = simulation.size, mean = 390000, sd = 50000)
# Professional Overhead
PO <- rtriangle(simulation.size, 172000, 279500, 215000)
IC <- Cost + LC + SC + CC + PO
# abline(v = cost2016, col="red", lwd=2)
# mtext("Cost 2006", at=cost2016, col="red")
# Summary
median(IC)
IC.mean <- mean(IC)
IC.sd <- sd(IC)
quantile(IC, c(.05, .95))
sd(IC)/mean(IC)
myhist <- hist(IC)
multiplier <- myhist$counts / myhist$density
mydensity <- dnorm(x=c(min(IC), max(IC), n = simulation.size))
mydensity$y <- mydensity$y * multiplier[1]
mydensity
x
dnorm(x=c(min(IC), max(IC), n = simulation.size))
min(IC)
max(IC)
mydensity <- dnorm(x=c(min(IC), max(IC), n = simulation.size), mean = IC.mean, sd = IC.sd))
mydensity <- dnorm(x=c(min(IC), max(IC), n = simulation.size), mean = IC.mean, sd = IC.sd)
mydensity
mydensity <- dnorm(x=c(min(IC), max(IC), n = simulation.size), mean = IC.mean, sd = IC.sd)
mydensity$y <- mydensity$y * multiplier[1]
multiplier
multiplier <- myhist$counts / myhist$density
multiplier
myhist$counts
myhist$density
myhist <- hist(IC)
h <- hist(IC, breaks = 10, density = 10,
col = "lightgray", xlab = "Accuracy", main = "Overall")
xfit <- seq(min(g), max(g), length = 40)
xfit <- seq(min(IC), max(IC), length = 40)
xfit
yfit <- dnorm(xfit, mean = mean(IC), sd = sd(IC))
yfit <- yfit * diff(h$mids[1:2]) * length(g)
yfit <- yfit * diff(h$mids[1:2]) * length(IC)
lines(xfit, yfit, col = "black", lwd = 2)
h <- hist(IC, breaks = 100, density = 10,
col = "lightgray", xlab = "Accuracy", main = "Overall")
h <- hist(IC, breaks = 100,
col = "lightgray", xlab = "Accuracy", main = "Overall")
xfit <- seq(min(IC), max(IC), length = 40)
yfit <- dnorm(xfit, mean = mean(IC), sd = sd(IC))
yfit <- yfit * diff(h$mids[1:2]) * length(IC)
lines(xfit, yfit, col = "black", lwd = 2)
h <- hist(IC, breaks = 100,
col = "lightgray", xlab = "Accuracy", main = "Overall")
xfit <- seq(min(IC), max(IC), length = 40)
yfit <- dnorm(xfit, mean = mean(IC), sd = sd(IC))
yfit <- yfit * diff(h$mids[1:2]) * length(IC)
lines(xfit, yfit, col = "blue", lwd = 2)
h <- hist(IC, breaks = 100, main='Initial Dry Well Cost 2019',
col = "lightgray", xlab = "Accuracy", main = "Overall")
h <- hist(IC, breaks = 100, main='Initial Dry Well Cost 2019',
col = "lightgray", xlab = "Accuracy", main = "Overall")
h <- hist(IC, breaks = 100, main='Initial Dry Well Cost 2019',
col = "lightgray", xlab = "Accuracy")
xfit <- seq(min(IC), max(IC), length = 40)
yfit <- dnorm(xfit, mean = mean(IC), sd = sd(IC))
yfit <- yfit * diff(h$mids[1:2]) * length(IC)
lines(xfit, yfit, col = "blue", lwd = 2)
# plot the histogray and add a normal line to check the fit
h <- hist(IC, breaks = 100, main='Initial Dry Well Cost 2019',
col = "lightgray", xlab = "Cost")
xfit <- seq(min(IC), max(IC), length = 40)
yfit <- dnorm(xfit, mean = mean(IC), sd = sd(IC))
yfit <- yfit * diff(h$mids[1:2]) * length(IC)
lines(xfit, yfit, col = "blue", lwd = 2)
